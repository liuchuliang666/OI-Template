???+ question "[P4723 【模板】常系数齐次线性递推](https://www.luogu.com.cn/problem/P4723)"
    求一个满足 $k$ 阶齐次线性递推数列 ${a_i}$ 的第 $n$ 项 $\text{mod} \ 998244353$ 的结果，即：

    $$a_n=\sum\limits_{i=1}^{k}f_i \times a_{n-i} \ \text{mod} \ 998244353$$

    $n \leq 10^{9}, k \leq 32000$，保证读入的数字均为 $[-10^9,10^9]$ 内的整数。

### 引入

事实上，我们并不需要使用任何线性代数的知识来导出这个做法。

让我们采用小学层面的方法求斐波那契数列（一个经典的例子）的第 $n$ 项。

我们换一个角度，倒过来求。假设我们现在在欲求 $F_n$。我们可以列出如下过程：$F_5 = F_4 + F_3 = 2F_3 + F_2 = 3F_2 + 2F_1 = 5F_1 + 3F_0$，最后带入 $F_0, F_1$ 计算即可。这当中的推导过程不是什么秘密，不过是每次取最前面那一项拿递推式展开罢了。

### 本质

考虑一下上述过程本质上究竟干了什么，上述过程，就是通过每次消去最高次项，求 $x^n$ 对斐波那契数列的特征多项式——$x^2 - x - 1$ 取模的结果的过程。如果还没有反应过来，展示如下：

$$
\begin{aligned}
& 0x^0 + 0x^1 + 0x^2 + 0x^3 + 0x^4 + 1x^5 \\
& \xrightarrow{-1x^3(x^2 - x -1)} 0x^0 + 0x^1 + 0x^2 + 1x^3 + 1x^4 \\
& \xrightarrow{-1x^2(x^2 - x -1)} 0x^0 + 0x^1 + 1x^2 + 2x^3 \\
& \xrightarrow{-2x^1(x^2 - x -1)} 0x^0 + 2x^1 + 3x^2 \\
& \xrightarrow{-3x^0(x^2 - x -1)} 3x^0 + 5x^1 \\
\end{aligned}
$$

两者之间的逻辑关联很简单，因为前者是每次取和式里下标最大那一项，替换成两个下标较小的项之后加回去；而后者是每次从多项式里减去若干倍的 $x^2$，并替换成相应倍数的 $x + 1$ 之后加回去。

### 推广到正解

理解了上述逻辑之后，能轻易将其推广到一般线性齐次递推式的情形：

$$f_i = p_1f_{i-1} + p_2f_{i-2} + \cdots + p_kf_{i-k}$$

要求 $f_n$，只要求多项式 $x^n$ 对

$$p(x) = x^k - p_1x^{k -1} - p_2x^{k -2} - \cdots - p_kx^0$$

取模的结果。因为「多项式取模」的过程恰好与「每次按递推式展开下标最大的项」的过程一致，都可以用「替换」来解读。

??? code "实现"
    ```cpp
    --8<-- "docs/Math/Poly/code/P4723.cpp"
    ```